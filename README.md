# NanoGPT Smart Home Assistant

This project demonstrates how to fine-tune a GPT-2 model to create a simple smart home assistant. The assistant learns to predict and automate actions based on simulated sensor data from a smart home environment.

## Features

- **Synthetic Data Generation:** Includes a script to generate realistic smart home sensor data for various scenarios like security alerts, welcome home routines, and energy-saving measures.
- **Model Fine-Tuning:** Provides a training script to fine-tune the GPT-2 model on the generated data.
- **Optimized for Consumer GPUs:** The training script is optimized to run on GPUs with as little as 10GB of VRAM.
- **Interactive Inference:** After training, you can interact with the model in real-time to see its predicted actions for given scenarios.

## How It Works

The project is divided into two main parts:

1.  **Data Generation (`home_sensor.py`):** This script creates a variety of smart home scenarios. Each scenario consists of `input` (a set of sensor readings) and a corresponding `output` (the desired action). This data is saved to a JSON file.

2.  **Training and Inference (`simpletrainer.py`):** This script performs the following steps:
    *   Loads the pre-trained GPT-2 model and tokenizer.
    *   Loads the training data generated by `home_sensor.py`.
    *   Fine-tunes the model on the data using the Hugging Face `Trainer` API.
    *   Saves the fine-tuned model.
    *   Provides an interactive command-line interface to test the model's predictions.

## Getting Started

### Prerequisites

- Python 3.6+
- PyTorch
- Transformers library from Hugging Face

### Installation

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/SumitLubal/nanogpt.git
    cd nanogpt
    ```

2.  **Install the dependencies:**
    ```bash
    pip install -r requirements.txt
    ```

### Usage

1.  **Generate Training Data:**
    Run the `home_sensor.py` script to create the training data file. You can customize the number of data entries to generate within the script.
    ```bash
    python home_sensor.py
    ```
    This will create a `smart_home_training_data_100.json` file (or similar, depending on your configuration).

2.  **Train the Model:**
    Run the `simpletrainer.py` script to fine-tune the model.
    ```bash
    python simpletrainer.py
    ```
    The script will save the fine-tuned model to the `./fine-tuned-model` directory.

3.  **Run Inference:**
    After training is complete, the `simpletrainer.py` script will automatically switch to an interactive inference mode. You can enter prompts to see how the model responds to different smart home scenarios.

## Dependencies

The main dependencies for this project are listed in the `requirements.txt` file and include:

- `torch`
- `transformers`
- `accelerate`
- `huggingface-hub`
- `numpy`

For a full list of dependencies, please see the `requirements.txt` file.
